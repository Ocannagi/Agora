<h2 style="margin-top: 40px;">{{titulo()}} - {{esEdicion() ? tipoEstadoKey() : ''}}</h2>

<app-mostrar-errores [errores]="errores()" ></app-mostrar-errores>

    @if(esCargando()) {
        <app-cargando/>
    } 

    <div class="form-grid">

        <app-autocompletar-periodos [disabled]="esNoDisponible()" (idPer)="perId.set($event)" [keywordExterno]="periodoEditDescripcion()" />

        <app-autocompletar-categorias [disabled]="esNoDisponible()" (idCat)="catId.set($event)" [keywordExterno]="categoriaEditDescripcion()"/>

        <app-autocompletar-subcategorias [disabled]="esNoDisponible()" [idCat]="catId()"  (idScat)="scatId.set($event)" [keywordExterno]="subcategoriaEditDescripcion()"/>

        <mat-form-field appearance="fill" class="col-span-2">
            <mat-label>Nombra la antigüedad</mat-label>
            <textarea #nombre [maxLength]="maxCaracteresNombre()" matInput [formControl]="antNombre" placeholder="Dale un nombre corto a la antigüedad"></textarea>
            <mat-hint>{{nombre.value.length}}/{{maxCaracteresNombre()}} caracteres</mat-hint>
            <mat-error>{{obtenerErrorAntNombre()}}</mat-error>
        </mat-form-field>

        <mat-form-field appearance="fill" class="col-span-2">
            <mat-label>Describe la antigüedad</mat-label>
            <textarea #descripcion [maxLength]="maxCaracteresDescripcion()" matInput [formControl]="antDescripcion" placeholder="Describe sus características, el año de creación, etc."></textarea>
            <mat-hint>{{descripcion.value.length}}/{{maxCaracteresDescripcion()}} caracteres</mat-hint>
            <mat-error>{{obtenerErrorAntDescripcion()}}</mat-error>
        </mat-form-field>

        @if(esEdicion()){
            <app-lista-imagenes-dto [(arrayImagenes)]="imagenesDTO"/>
            <div class="btnAgregarImagenesContainer">
                <button type="button" mat-flat-button
                    (click)="openDialog()"
                    [disabled]="deshabilitarAgregarImagenes()"
                    [class.disabled]="deshabilitarAgregarImagenes()">Agregar más imágenes</button>
            </div>
        }@else {
            <app-upload-imagenes-antiguedad
            [(arrayImgFiles)]="imagenesFiles"
            [arrayNameImgExistentes]="arrayNameImgExistentes()"
            />
        }

    </div>

    <div class="contenedor-botones">
      <button type="button" mat-flat-button [disabled]="isNotAllValid() || EsEdicionYNoHayCambios()" (click)="onSubmit()">Guardar cambios</button>
      <!-- antes: routerLink="/antiguedades" -->
      <button type="button" mat-stroked-button (click)="onCancel()">Cancelar</button>
      <!-- <button type="button" mat-stroked-button (click)="ConsoleValidFormulario()">Prueba formulario</button> -->
    </div>


<app-mostrar-errores [errores]="errores()" ></app-mostrar-errores>


